<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Water Boy's monthly specials and coupons web app is coming soon. Sign up for registre and exclusive offers!">
    <title>Water Boy Monthly Specials - Coming Soon</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="wave.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&family=Montserrat:wght@600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="container">
        <header>
            <img src="logo.png" alt="Water Boy Logo" class="logo">
            <h1>Exclusive<br>WaterBoy Monthly Offers</h1>
        </header>
        <main>
            <section class="hero">
                <h2>Exciting Specials Coming Soon!</h2>
                <p>Welcome to our Web App for monthly coupons and specials, where we deliver offers for just being a WaterBoy customer.</p>
            </section>
            <section class="previous-specials">
                <h3>Previous Months' Specials</h3>
                <select id="previous-specials-dropdown" aria-label="Previous Months' Specials">
                    <option value="" disabled selected>Select a special</option>
                    <option value="feb2025">Feb 2025: 15% off Bulk Orders</option>
                    <option value="jan2025">Jan 2025: Buy 2 Get 1 Free</option>
                    <option value="dec2024">Dec 2024: 10% off All Rentals</option>
                </select>
                <button type="button" class="btn claim-coupon" data-dropdown="previous">Claim Coupon</button>
            </section>
            <section class="current-specials">
                <h3>Current Month's Specials</h3>
                <select id="current-specials-dropdown" aria-label="Current Month's Specials">
                    <option value="" disabled selected>Select a special</option>
                    <option value="special1">March 2025: 20% off 5L Bottles</option>
                    <option value="special2">March 2025: Free Dispenser Rental</option>
                </select>
                <button type="button" class="btn claim-coupon" data-dropdown="current">Claim Coupon</button>
            </section>
            
            <section class="signup">
                <h3>Stay Updated</h3>
                <p>Sign up to receive updates on our web app launch and exclusive offers and deals. At WaterBoy we deliver!</p>
                <form id="client-form">
                    <div class="form-group">
                        <label><input type="radio" name="client-status" value="yes"> Yes</label>
                        <label><input type="radio" name="client-status" value="no"> No</label>
                        <button type="submit" class="btn">Submit</button>
                    </div>
                    <p class="form-message" id="form-message"></p>
                </form>
            </section>
            <section class="contact">
                <h3>Need Current Specials?</h3>
                <p>Contact us to learn about our latest offers on rentals and deliveries:</p>
                <p><a href="mailto:water8boy@gmail.com" class="contact-link"><i class="fas fa-envelope"></i> water8boy@gmail.com</a> | <a href="tel:+27789069543" class="contact-link"><i class="fas fa-phone"></i> +27 78 906 9543</a></p>
            </section>
        </main>
        <footer>
            <p>Follow us on social media for updates:</p>
            <div class="social-links">
                <a href="https://www.facebook.com/water8boypotch" target="_blank" aria-label="Follow Water Boy on Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.instagram.com/waterboypotch/" target="_blank" aria-label="Follow Water Boy on Instagram"><i class="fab fa-instagram"></i></a>
            </div>
            <p>Visit <a href="https://www.water-boy.co.za">www.water-boy.co.za</a> for more information about our services.</p>
        </footer>
    </div>

    <script>
        // Google Apps Script Web App URL for Current Specials
        const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwqyG-OOGlEawpFshQe63uo_BkrRUQX5MW3iVXhr-3fA1xvnLFsW2d6NIw3Y2hkosY9/exec';

        // Client Form Submission (unchanged)
        document.getElementById('client-form').addEventListener('submit', function(event) {
            event.preventDefault();
            event.stopPropagation();

            const formMessage = document.getElementById('form-message');
            const clientStatus = document.querySelector('input[name="client-status"]:checked');

            formMessage.textContent = '';
            formMessage.style.display = 'none';

            if (!clientStatus) {
                formMessage.textContent = 'Please select Yes or No.';
                formMessage.style.color = '#dc3545';
                formMessage.style.display = 'block';
                return;
            }

            if (clientStatus.value === 'yes') {
                Swal.fire({
                    title: 'Customer Status',
                    text: 'Are you an existing WaterBoy customer or a new one?',
                    showCancelButton: true,
                    confirmButtonText: 'Existing',
                    cancelButtonText: 'New',
                    icon: 'question'
                }).then((result) => {
                    formMessage.style.display = 'block';
                    if (result.isConfirmed) {
                        window.open('https://docs.google.com/forms/d/e/1FAIpQLScSOBn22FQYogZYlcj77if4YDsFU2CNYvwpadEq_5ZsxcovDQ/viewform?usp=header', '_blank');
                        formMessage.textContent = 'Welcome back, existing customer!';
                        formMessage.style.color = '#28a745';
                    } else {
                        window.open('https://docs.google.com/forms/d/e/1FAIpQLSd1q-aAeSbdo8dYVz2TmSkEriaobTH3XX0iWkchwUo8u2fSfQ/viewform?usp=header', '_blank');
                        formMessage.textContent = 'Welcome, new customer!';
                        formMessage.style.color = '#28a745';
                    }
                });
            } else if (clientStatus.value === 'no') {
                Swal.fire({
                    title: 'Thank You',
                    text: 'Thank you for choosing WaterBoy. We appreciate your interest and look forward to serving you!',
                    confirmButtonText: 'Understood',
                    icon: 'success'
                }).then(() => {
                    formMessage.textContent = 'We are excited to have you on board!';
                    formMessage.style.color = '#28a745';
                    formMessage.style.display = 'block';
                });
            }
        });

        // Claim Coupon Buttons
        document.querySelectorAll('.claim-coupon').forEach(button => {
            button.addEventListener('click', async function() {
                const dropdownType = this.getAttribute('data-dropdown');
                const dropdown = document.getElementById(`${dropdownType}-specials-dropdown`);
                const selectedOption = dropdown.options[dropdown.selectedIndex].text;

                if (dropdown.selectedIndex === 0) { // No option selected
                    Swal.fire({
                        title: 'Error',
                        text: 'Please select a special to claim a coupon.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    return;
                }

                if (dropdownType === 'previous') {
                    // Previous Specials: Email or Cell Number popup, submit to Google Form
                    const { value: formValues } = await Swal.fire({
                        title: 'Claim Previous Coupon',
                        html:
                            '<input id="swal-input1" class="swal2-input" placeholder="Email (optional)" type="email">' +
                            '<input id="swal-input2" class="swal2-input" placeholder="Cell Number (optional)" type="tel">',
                        focusConfirm: false,
                        showCancelButton: true,
                        confirmButtonText: 'Submit',
                        cancelButtonText: 'Cancel',
                        preConfirm: () => {
                            const email = document.getElementById('swal-input1').value;
                            const cell = document.getElementById('swal-input2').value;
                            if (!email && !cell) {
                                Swal.showValidationMessage('Please enter either an email or a cell number');
                                return false;
                            }
                            if (email && !/\S+@\S+\.\S+/.test(email)) {
                                Swal.showValidationMessage('Please enter a valid email address');
                                return false;
                            }
                            if (cell && !/^\d{10,}$/.test(cell)) {
                                Swal.showValidationMessage('Please enter a valid cell number (at least 10 digits)');
                                return false;
                            }
                            return { email, cell };
                        }
                    });

                    if (formValues) {
                        // Submit to Google Form silently
                        const formUrl = 'https://docs.google.com/forms/d/e/1FAIpQLSfxC9EXSrTbrYPJjOcfQhrjPnBYW9tWg2qxSQcAEpCM6FUcJQ/formResponse';
                        const formData = new FormData();
                        // Replace these entry IDs with your actual Google Form field IDs
                        formData.append('entry.1234567890', selectedOption); // Coupon (placeholder ID)
                        formData.append('entry.987654321', formValues.email || ''); // Email (placeholder ID)
                        formData.append('entry.456789123', formValues.cell || ''); // Cell (placeholder ID)

                        fetch(formUrl, {
                            method: 'POST',
                            mode: 'no-cors', // Silent submission
                            body: formData
                        })
                        .then(() => {
                            Swal.fire({
                                title: 'Coupon Claimed!',
                                text: `You have successfully claimed: ${selectedOption}. Details recorded.`,
                                icon: 'success',
                                confirmButtonText: 'Great'
                            });
                        })
                        .catch(error => {
                            console.error('Error submitting to form:', error);
                            Swal.fire({
                                title: 'Error',
                                text: 'Failed to save your claim. Please try again.',
                                icon: 'error',
                                confirmButtonText: 'OK'
                            });
                        });
                    }
                } else if (dropdownType === 'current') {
                    // Current Specials: Existing behavior with Google Sheet
                    const { value: formValues } = await Swal.fire({
                        title: 'Claim Your Coupon',
                        html:
                            '<input id="swal-input1" class="swal2-input" placeholder="Email" type="email" required>' +
                            '<input id="swal-input2" class="swal2-input" placeholder="Cell Number" type="tel" required>',
                        focusConfirm: false,
                        showCancelButton: true,
                        confirmButtonText: 'Submit',
                        cancelButtonText: 'Cancel',
                        preConfirm: () => {
                            const email = document.getElementById('swal-input1').value;
                            const cell = document.getElementById('swal-input2').value;
                            if (!email || !cell) {
                                Swal.showValidationMessage('Please enter both email and cell number');
                                return false;
                            }
                            if (!/\S+@\S+\.\S+/.test(email)) {
                                Swal.showValidationMessage('Please enter a valid email address');
                                return false;
                            }
                            if (!/^\d{10,}$/.test(cell)) {
                                Swal.showValidationMessage('Please enter a valid cell number (at least 10 digits)');
                                return false;
                            }
                            return { email, cell };
                        }
                    });

                    if (formValues) {
                        const data = {
                            coupon: selectedOption,
                            email: formValues.email,
                            cell: formValues.cell
                        };

                        fetch(GOOGLE_SHEET_URL, {
                            method: 'POST',
                            mode: 'no-cors',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(data)
                        })
                        .then(() => {
                            Swal.fire({
                                title: 'Coupon Claimed!',
                                text: `You have successfully claimed: ${selectedOption}. Details sent to ${formValues.email} and ${formValues.cell}.`,
                                icon: 'success',
                                confirmButtonText: 'Great'
                            });
                        })
                        .catch(error => {
                            console.error('Error saving to sheet:', error);
                            Swal.fire({
                                title: 'Error',
                                text: 'Failed to save your claim. Please try again.',
                                icon: 'error',
                                confirmButtonText: 'OK'
                            });
                        });
                    }
                }
            });
        });
    </script>
</body>
</html>